<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tree Believability • dlptools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Noto_Sans_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tree Believability">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dlptools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/heatmaps.html">Flexible Heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/tree_believability.html">Tree Believability</a></li>
    <li><a class="dropdown-item" href="../articles/useful_functions.html">Functions in this package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Tree Believability</h1>
            
      

      <div class="d-none name"><code>tree_believability.Rmd</code></div>
    </div>

    
    
<pre><code><span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span></code></pre>
<p>With DLP data, we often need to build a tree to sort out
relationships among the cells. There exists multiple methods to building
trees <a href="https://bitbucket.org/schwarzlab/medicc2/src/master/" class="external-link">medicc</a>,
<a href="https://github.com/samsonweiner/DICE/tree/main?tab=readme-ov-file" class="external-link">dice</a>,
<a href="https://github.com/UBC-Stat-ML/sitkatree" class="external-link">sitka</a>, each with
their own suite of parameters. As well, there are multiple approachs to
prep the data for tree building (filtering, etc).</p>
<p><br></p>
<p>In the absence of simulations that match the complexity of whatever
data we have on hand, how do we know when one confluence of settings is
“better” than the other?</p>
<p>Often we look at heatmaps with trees and just sort of “check the
vibe”.</p>
<p><br><br></p>
<p>For example:</p>
<p><img src="imgs%2Freal_tree.png" width="60%" height="50%" style="display: block; margin: auto;"><img src="imgs%2Frand_tree.png" width="60%" height="50%" style="display: block; margin: auto;"><br></p>
<p>were we probably trust the top result more than the bottom
results.</p>
<p><br></p>
<p>But what is this “<strong>vibe</strong>” that we are checking?</p>
<p><br></p>
<p>Generally, when a tree building algorithm is doing well, it should
group more similar taxa closer together in the tree. When we look at
heatmaps of copy number, that’s probably what we are cueing on visually,
is an overall high level of grouping for cells that have similar states
across the genome.</p>
<p>We can capture this sentiment by evalutating the degree of state
similarity between sibling taxa.</p>
<div class="section level2">
<h2 id="the-metric">The Metric<a class="anchor" aria-label="anchor" href="#the-metric"></a>
</h2>
<p>The idea employed here is simple, when comparing trees, the “better”
one will have sister taxa that are more similar to one another.</p>
<p>We can evaluate this in a non-perfect way by evaluting string
distance between states across the genome of sibling tree tips. (See the
section <strong>Future Thoughts</strong> below for why this isn’t a
perfect method.)</p>
<p><br></p>
<p>Starting with some toy data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># starting with a simple tree</span></span>
<span><span class="va">toy_tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"(A, (B, C));"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># and 3 bins of state data for each tip</span></span>
<span><span class="va">toy_states</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  cell_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">19</span>, <span class="fl">29</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  chr <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># making a matrix for the plot</span></span>
<span><span class="va">toy_w</span> <span class="op">&lt;-</span> <span class="fu">dlptools</span><span class="fu">::</span><span class="fu"><a href="../reference/convert_long_reads_to_wide.html">convert_long_reads_to_wide</a></span><span class="op">(</span><span class="va">toy_states</span><span class="op">)</span></span>
<span><span class="va">toy_mat</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">toy_w</span>, <span class="op">-</span><span class="va">cell_id</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">toy_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">toy_w</span><span class="op">$</span><span class="va">cell_id</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">toy_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"character"</span></span>
<span></span>
<span><span class="va">toy_p</span> <span class="op">&lt;-</span> <span class="fu">ggtree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree</a></span><span class="op">(</span><span class="va">toy_tree</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html" class="external-link">geom_tiplab</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_nodelab.html" class="external-link">geom_nodelab</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html" class="external-link">geom_tiplab</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggtree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html" class="external-link">gheatmap</a></span><span class="op">(</span><span class="va">toy_p</span>, <span class="va">toy_mat</span>, colnames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">dlptools</span><span class="fu">::</span><span class="va"><a href="../reference/CNV_COLOURS.html">CNV_COLOURS</a></span><span class="op">)</span></span></code></pre></div>
<p><img src="tree_believability_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<p>3 tips with 3 bins of state data. Node/tip numbers highlighted in
red.</p>
<p><br><br><br><br></p>
<p>These bin states can be represented as a string of states for each
cell:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toy_state_strings</span> <span class="op">&lt;-</span> <span class="fu">dlptools</span><span class="fu">::</span><span class="fu"><a href="../reference/cell_states_to_strings.html">cell_states_to_strings</a></span><span class="op">(</span><span class="va">toy_states</span><span class="op">)</span></span>
<span><span class="va">toy_state_strings</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   tip_label states_string</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         EEE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B         EII          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C         EIC</span></span></code></pre></div>
<p><em>note</em>: the states are converted to letters so that double
digit states don’t count as 2 characters.</p>
<p>i.e.,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dlptools</span><span class="fu">::</span><span class="fu"><a href="../reference/map_states_to_letters.html">map_states_to_letters</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="co">#&gt;   0   1   2   3   4   5   6   7   8   9  10  11 </span></span>
<span><span class="co">#&gt; "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L"</span></span></code></pre></div>
<p><br><br></p>
<p>We can compute the sibling nodes for each of the tips:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">phangorn</span><span class="fu">::</span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/Ancestors.html" class="external-link">Siblings</a></span><span class="op">(</span><span class="va">toy_tree</span>, node <span class="op">=</span> <span class="va">toy_tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>The output is a bit confusing, but basically the element of the list
<code>[[2]]</code> (aka, tip <code>B</code>) represents the node of the
tip, and the entry <code>3</code> represents its sibling node (aka, tip
<code>C</code>).</p>
<p><br><br></p>
<p>So in this tree, taxa B and C are sister taxa, and we can compute
their distance from each other:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for demonstration, doing "by hand"...will show more automated methods below</span></span>
<span><span class="va">b_string</span> <span class="op">&lt;-</span> <span class="va">toy_state_strings</span><span class="op">[</span><span class="va">toy_state_strings</span><span class="op">$</span><span class="va">tip_label</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="op">]</span><span class="op">$</span><span class="va">states_string</span></span>
<span><span class="va">c_string</span> <span class="op">&lt;-</span> <span class="va">toy_state_strings</span><span class="op">[</span><span class="va">toy_state_strings</span><span class="op">$</span><span class="va">tip_label</span> <span class="op">==</span> <span class="st">"C"</span>, <span class="op">]</span><span class="op">$</span><span class="va">states_string</span></span>
<span></span>
<span><span class="va">b_c_dist</span> <span class="op">&lt;-</span> <span class="fu">stringdist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringdist/man/stringdist.html" class="external-link">stringdist</a></span><span class="op">(</span><span class="va">b_string</span>, <span class="va">c_string</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_c_dist</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>distance of 1 because there is 1 bin with a diffrence.</p>
<p><br><br></p>
<p>For A, it’s a bit more tricky because the whole clade containing B
and C (i.e., node <code>5</code>) are the sister taxa.</p>
<p><img src="tree_believability_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The approach taken here is to calculate the distance to each and take
the mean:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_string</span> <span class="op">&lt;-</span> <span class="va">toy_state_strings</span><span class="op">[</span><span class="va">toy_state_strings</span><span class="op">$</span><span class="va">tip_label</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="op">]</span><span class="op">$</span><span class="va">states_string</span></span>
<span></span>
<span><span class="va">a_to_bc_dists</span> <span class="op">&lt;-</span> <span class="fu">stringdist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringdist/man/stringdist.html" class="external-link">stringdist</a></span><span class="op">(</span><span class="va">a_string</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b_string</span>, <span class="va">c_string</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a_to_bc_dists</span></span>
<span><span class="co">#&gt; [1] 2 2</span></span></code></pre></div>
<p>And then for the whole tree, we can just take the mean of all the
sibling distances:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b_c_dist</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">a_to_bc_dists</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
<p><br><br></p>
<p>Of course, that is too much work, so we can just call the
function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dlptools</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_tip_sibling_distances.html">compute_tip_sibling_distances</a></span><span class="op">(</span></span>
<span>  states_df <span class="op">=</span> <span class="va">toy_states</span>, <span class="co"># the long format state data</span></span>
<span>  tree <span class="op">=</span> <span class="va">toy_tree</span>,</span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="real-ish-data-example">Real(-ish) Data Example<a class="anchor" aria-label="anchor" href="#real-ish-data-example"></a>
</h2>
<p>This computed value doesn’t mean anything on it’s own – it’s just a
number. It’s meant as a comparison tool to other trees.</p>
<p>Returning to the trees at the start of this vignette, we can assess
how well each did:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># loading the data and tree underlying those plots at the top</span></span>
<span><span class="va">ex_tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="st">"data/tree_support.nwk"</span><span class="op">)</span></span>
<span><span class="va">dlp_states</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html" class="external-link">vroom</a></span><span class="op">(</span><span class="st">"data/tree_support_states.tsv.gz"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># generate a random tree as the "bad tree"</span></span>
<span><span class="va">rand_tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ex_tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rand_tree</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">ex_tree</span><span class="op">$</span><span class="va">tip.label</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ex_tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The real tree:</p>
<p><img src="imgs%2Freal_tree.png" width="60%" height="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dlptools</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_tip_sibling_distances.html">compute_tip_sibling_distances</a></span><span class="op">(</span></span>
<span>  states_df <span class="op">=</span> <span class="va">dlp_states</span>,</span>
<span>  tree <span class="op">=</span> <span class="va">ex_tree</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 407.7623</span></span></code></pre></div>
<p>The random tree:</p>
<p><img src="imgs%2Frand_tree.png" width="60%" height="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dlptools</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_tip_sibling_distances.html">compute_tip_sibling_distances</a></span><span class="op">(</span></span>
<span>  states_df <span class="op">=</span> <span class="va">dlp_states</span>,</span>
<span>  tree <span class="op">=</span> <span class="va">rand_tree</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 588.8788</span></span></code></pre></div>
<p><br></p>
<p>And, as expected, the random tree is worse. The “mean sibling state
string distance” (that’s a mouthful…how about the “MS3D”?) is higher in
the random tree.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># and for fun, you can call for the same results</span></span>
<span><span class="fu">dlptools</span><span class="fu">::</span><span class="fu"><a href="../reference/check_the_vibe.html">check_the_vibe</a></span><span class="op">(</span><span class="va">dlp_states</span>, <span class="va">ex_tree</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 407.7623</span></span></code></pre></div>
<p><br><br><br><br></p>
</div>
<div class="section level2">
<h2 id="future-thoughts">Future Thoughts<a class="anchor" aria-label="anchor" href="#future-thoughts"></a>
</h2>
<p>Why are string distances not ideal?</p>
<p>When evaluating the distance between two strings with simple methods,
any change adds to the distance equally. So from ‘AAA’, ‘AAZ’ is as
distant as ‘AAB’ (both 1 character different). But in the world of copy
number states, that’s not the reality. Compared to a state of 2, a state
9 is more different than a state 3 or 4.</p>
<p>Ideally, to calculate distance we’d have a custom scoring matrix that
acknowledges the degree of change. However, it would also have to
account for realistic mutation processes like WGD. For example, starting
from a state of 3, a state of 6 could be a single mutational step away
(i.e., 1 WGD event), whereas a state of 5 is <em>potentially</em> 2
steps away: either single amplifications of 3-&gt;4-&gt;5 or a WGD
followed by loss 3-&gt;6-&gt;5.</p>
<p><br></p>
<p>So should a 3 and 6 count as a distance of 1 and 3 and 5 be a
distance of 2?</p>
<p><br></p>
<p>Thinking through all of the possibilities leads to all kinds of
oddities. E.g., when coming up with a distance of state 3 and 12, that
could be just 2 events 3-WGD-&gt;6-WGD-&gt;12. But for state 3 and 9, it
minimally is likely 4 events.</p>
<p>And the reality is that there are infinite ways one state could
mutate to another state, it can’t be known.</p>
<p>So in absence of an obvious way to say how different numbers like 3
are from numbers like 6, 9, and 12, this method here sticks with an
unrealistic method of just string distances.</p>
<p><br></p>
<p>Sorting out some transition matrix that captures this just for the
method here is very likely overkill…but could be quite helpful for
ancestral state recontruction of CNV events…</p>
<p><br><br><br><br></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Furman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
